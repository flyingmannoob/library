{"remainingRequest":"E:\\Study\\D1\\暑期实训\\大作业\\lib\\frontend\\node_modules\\babel-loader\\lib\\index.js!E:\\Study\\D1\\暑期实训\\大作业\\lib\\frontend\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\Study\\D1\\暑期实训\\大作业\\lib\\frontend\\src\\store\\modules\\user.js","dependencies":[{"path":"E:\\Study\\D1\\暑期实训\\大作业\\lib\\frontend\\src\\store\\modules\\user.js","mtime":1756956688669},{"path":"E:\\Study\\D1\\暑期实训\\大作业\\lib\\frontend\\babel.config.js","mtime":1756907620051},{"path":"E:\\Study\\D1\\暑期实训\\大作业\\lib\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1756907623548},{"path":"E:\\Study\\D1\\暑期实训\\大作业\\lib\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1756907622480},{"path":"E:\\Study\\D1\\暑期实训\\大作业\\lib\\frontend\\node_modules\\eslint-loader\\index.js","mtime":1756907627688}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyI7CmltcG9ydCB7IGxvZ2luIGFzIF9sb2dpbiwgbG9nb3V0IGFzIF9sb2dvdXQsIGdldEluZm8gYXMgX2dldEluZm8gfSBmcm9tICdAL2FwaS91c2VyJzsKaW1wb3J0IHsgZ2V0VG9rZW4sIHNldFRva2VuLCByZW1vdmVUb2tlbiB9IGZyb20gJ0AvdXRpbHMvYXV0aCc7CmltcG9ydCB7IHJlc2V0Um91dGVyIH0gZnJvbSAnQC9yb3V0ZXInOwp2YXIgZ2V0RGVmYXVsdFN0YXRlID0gZnVuY3Rpb24gZ2V0RGVmYXVsdFN0YXRlKCkgewogIHJldHVybiB7CiAgICB0b2tlbjogZ2V0VG9rZW4oKSwKICAgIG5hbWU6ICcnLAogICAgYXZhdGFyOiAnJywKICAgIHJvbGVzOiBbXQogIH07Cn07CnZhciBzdGF0ZSA9IGdldERlZmF1bHRTdGF0ZSgpOwp2YXIgbXV0YXRpb25zID0gewogIFJFU0VUX1NUQVRFOiBmdW5jdGlvbiBSRVNFVF9TVEFURShzdGF0ZSkgewogICAgT2JqZWN0LmFzc2lnbihzdGF0ZSwgZ2V0RGVmYXVsdFN0YXRlKCkpOwogIH0sCiAgU0VUX1RPS0VOOiBmdW5jdGlvbiBTRVRfVE9LRU4oc3RhdGUsIHRva2VuKSB7CiAgICBzdGF0ZS50b2tlbiA9IHRva2VuOwogIH0sCiAgU0VUX05BTUU6IGZ1bmN0aW9uIFNFVF9OQU1FKHN0YXRlLCBuYW1lKSB7CiAgICBzdGF0ZS5uYW1lID0gbmFtZTsKICB9LAogIFNFVF9BVkFUQVI6IGZ1bmN0aW9uIFNFVF9BVkFUQVIoc3RhdGUsIGF2YXRhcikgewogICAgc3RhdGUuYXZhdGFyID0gYXZhdGFyOwogIH0sCiAgU0VUX1JPTEVTOiBmdW5jdGlvbiBTRVRfUk9MRVMoc3RhdGUsIHJvbGVzKSB7CiAgICBzdGF0ZS5yb2xlcyA9IHJvbGVzOwogIH0KfTsKdmFyIGFjdGlvbnMgPSB7CiAgLy8gdXNlciBsb2dpbgogIGxvZ2luOiBmdW5jdGlvbiBsb2dpbihfcmVmLCB1c2VySW5mbykgewogICAgdmFyIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgdmFyIHVzZXJuYW1lID0gdXNlckluZm8udXNlcm5hbWUsCiAgICAgIHBhc3N3b3JkID0gdXNlckluZm8ucGFzc3dvcmQ7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBfbG9naW4oewogICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZS50cmltKCksCiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgIGNvbW1pdCgnU0VUX1RPS0VOJywgZGF0YS50b2tlbik7CiAgICAgICAgc2V0VG9rZW4oZGF0YS50b2tlbik7CiAgICAgICAgcmVzb2x2ZSgpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgLy8gZ2V0IHVzZXIgaW5mbwogIGdldEluZm86IGZ1bmN0aW9uIGdldEluZm8oX3JlZjIpIHsKICAgIHZhciBjb21taXQgPSBfcmVmMi5jb21taXQsCiAgICAgIHN0YXRlID0gX3JlZjIuc3RhdGU7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBfZ2V0SW5mbyhzdGF0ZS50b2tlbikudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgaWYgKCFkYXRhKSB7CiAgICAgICAgICByZXR1cm4gcmVqZWN0KCdWZXJpZmljYXRpb24gZmFpbGVkLCBwbGVhc2UgTG9naW4gYWdhaW4uJyk7CiAgICAgICAgfQoKICAgICAgICAvLyDnoa7kv53op5LoibLmlbDmja7moLzlvI/mraPnoa4KICAgICAgICB2YXIgbmFtZSA9IGRhdGEubmFtZSwKICAgICAgICAgIGF2YXRhciA9IGRhdGEuYXZhdGFyLAogICAgICAgICAgcm9sZXMgPSBkYXRhLnJvbGVzOwoKICAgICAgICAvLyDlpoLmnpxyb2xlc+S4jeWtmOWcqOaIluS4uuepuu+8jOiuvue9rum7mOiupOinkuiJsgogICAgICAgIGlmICghcm9sZXMgfHwgQXJyYXkuaXNBcnJheShyb2xlcykgJiYgcm9sZXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICByb2xlcyA9IFsndXNlciddOwogICAgICAgICAgY29uc29sZS53YXJuKCfmnKrojrflj5bliLDnlKjmiLfop5LoibLvvIzorr7nva7kuLrpu5jorqTnlKjmiLfop5LoibInKTsKICAgICAgICB9CgogICAgICAgIC8vIOehruS/nXJvbGVz5piv5pWw57uE5qC85byPCiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHJvbGVzKSkgewogICAgICAgICAgcm9sZXMgPSBbcm9sZXNdOwogICAgICAgIH0KICAgICAgICBjb25zb2xlLmxvZygn55So5oi35L+h5oGvIC0g5aeT5ZCNOicsIG5hbWUsICfop5LoibI6Jywgcm9sZXMpOwogICAgICAgIGNvbW1pdCgnU0VUX05BTUUnLCBuYW1lKTsKICAgICAgICBjb21taXQoJ1NFVF9BVkFUQVInLCBhdmF0YXIpOwogICAgICAgIGNvbW1pdCgnU0VUX1JPTEVTJywgcm9sZXMpOwogICAgICAgIHJlc29sdmUoZGF0YSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPlueUqOaIt+S/oeaBr+Wksei0pTonLCBlcnJvcik7CiAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgfSk7CiAgICB9KTsKICB9LAogIC8vIHVzZXIgbG9nb3V0CiAgbG9nb3V0OiBmdW5jdGlvbiBsb2dvdXQoX3JlZjMpIHsKICAgIHZhciBjb21taXQgPSBfcmVmMy5jb21taXQsCiAgICAgIHN0YXRlID0gX3JlZjMuc3RhdGU7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBfbG9nb3V0KHN0YXRlLnRva2VuKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICByZW1vdmVUb2tlbigpOyAvLyBtdXN0IHJlbW92ZSAgdG9rZW4gIGZpcnN0CiAgICAgICAgcmVzZXRSb3V0ZXIoKTsKICAgICAgICBjb21taXQoJ1JFU0VUX1NUQVRFJyk7CiAgICAgICAgcmVzb2x2ZSgpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgLy8gcmVtb3ZlIHRva2VuCiAgcmVzZXRUb2tlbjogZnVuY3Rpb24gcmVzZXRUb2tlbihfcmVmNCkgewogICAgdmFyIGNvbW1pdCA9IF9yZWY0LmNvbW1pdDsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICByZW1vdmVUb2tlbigpOyAvLyBtdXN0IHJlbW92ZSAgdG9rZW4gIGZpcnN0CiAgICAgIGNvbW1pdCgnUkVTRVRfU1RBVEUnKTsKICAgICAgcmVzb2x2ZSgpOwogICAgfSk7CiAgfQp9OwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZXNwYWNlZDogdHJ1ZSwKICBzdGF0ZTogc3RhdGUsCiAgbXV0YXRpb25zOiBtdXRhdGlvbnMsCiAgYWN0aW9uczogYWN0aW9ucwp9Ow=="},{"version":3,"names":["login","logout","getInfo","getToken","setToken","removeToken","resetRouter","getDefaultState","token","name","avatar","roles","state","mutations","RESET_STATE","Object","assign","SET_TOKEN","SET_NAME","SET_AVATAR","SET_ROLES","actions","_ref","userInfo","commit","username","password","Promise","resolve","reject","trim","then","response","data","catch","error","_ref2","Array","isArray","length","console","warn","log","_ref3","resetToken","_ref4","namespaced"],"sources":["E:/Study/D1/暑期实训/大作业/lib/frontend/src/store/modules/user.js"],"sourcesContent":["import { login, logout, getInfo } from '@/api/user'\r\nimport { getToken, setToken, removeToken } from '@/utils/auth'\r\nimport { resetRouter } from '@/router'\r\n\r\nconst getDefaultState = () => {\r\n  return {\r\n    token: getToken(),\r\n    name: '',\r\n    avatar: '',\r\n    roles: []\r\n  }\r\n}\r\n\r\nconst state = getDefaultState()\r\n\r\nconst mutations = {\r\n  RESET_STATE: (state) => {\r\n    Object.assign(state, getDefaultState())\r\n  },\r\n  SET_TOKEN: (state, token) => {\r\n    state.token = token\r\n  },\r\n  SET_NAME: (state, name) => {\r\n    state.name = name\r\n  },\r\n  SET_AVATAR: (state, avatar) => {\r\n    state.avatar = avatar\r\n  },\r\n  SET_ROLES: (state, roles) => {\r\n    state.roles = roles\r\n  }\r\n}\r\n\r\nconst actions = {\r\n  // user login\r\n  login({ commit }, userInfo) {\r\n    const { username, password } = userInfo\r\n    return new Promise((resolve, reject) => {\r\n      login({ username: username.trim(), password: password }).then(response => {\r\n        const { data } = response\r\n        commit('SET_TOKEN', data.token)\r\n        setToken(data.token)\r\n        resolve()\r\n      }).catch(error => {\r\n        reject(error)\r\n      })\r\n    })\r\n  },\r\n\r\n  // get user info\r\n  getInfo({ commit, state }) {\r\n    return new Promise((resolve, reject) => {\r\n      getInfo(state.token).then(response => {\r\n        const { data } = response\r\n\r\n        if (!data) {\r\n          return reject('Verification failed, please Login again.')\r\n        }\r\n\r\n        // 确保角色数据格式正确\r\n        let { name, avatar, roles } = data\r\n\r\n        // 如果roles不存在或为空，设置默认角色\r\n        if (!roles || (Array.isArray(roles) && roles.length === 0)) {\r\n          roles = ['user']\r\n          console.warn('未获取到用户角色，设置为默认用户角色')\r\n        }\r\n\r\n        // 确保roles是数组格式\r\n        if (!Array.isArray(roles)) {\r\n          roles = [roles]\r\n        }\r\n\r\n        console.log('用户信息 - 姓名:', name, '角色:', roles)\r\n\r\n        commit('SET_NAME', name)\r\n        commit('SET_AVATAR', avatar)\r\n        commit('SET_ROLES', roles)\r\n        resolve(data)\r\n      }).catch(error => {\r\n        console.error('获取用户信息失败:', error)\r\n        reject(error)\r\n      })\r\n    })\r\n  },\r\n\r\n  // user logout\r\n  logout({ commit, state }) {\r\n    return new Promise((resolve, reject) => {\r\n      logout(state.token).then(() => {\r\n        removeToken() // must remove  token  first\r\n        resetRouter()\r\n        commit('RESET_STATE')\r\n        resolve()\r\n      }).catch(error => {\r\n        reject(error)\r\n      })\r\n    })\r\n  },\r\n\r\n  // remove token\r\n  resetToken({ commit }) {\r\n    return new Promise(resolve => {\r\n      removeToken() // must remove  token  first\r\n      commit('RESET_STATE')\r\n      resolve()\r\n    })\r\n  }\r\n}\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  mutations,\r\n  actions\r\n}\r\n"],"mappings":"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","ignoreList":[]}]}